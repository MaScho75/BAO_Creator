<!DOCTYPE html>

<html lang="de">
	
	<head>
		
		<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
		<meta content="width=device-width, initial-scale=1.0" name="viewport">
		<meta content="noindex" name="robots">
		<meta content="nofollow" name="robots">
		<meta content="no-cache" http-equiv="cache-control">
		<meta content="EPHK Schommer, Marcel, A 45/4, marcel.schommer@polizei.berlin.de" name="author">
		<meta content="(c)2024 - Polizei Berlin" name="copyright">
		<title>Grafischer Befehl</title>
			
		<style type="text/css">

			#Digigruppe {
				height: 55px;
			}
				
			#LinienGB {
				position: absolute;
				display: block;
				width: 1000px;
				height: 500px;
				top: 0px;
				left: 0px;
				z-index: -100;
			}
				
			#BAOplus {
				position: absolute;
				display: visible;
				left: 215px;
				top: 15px;
				text-align: center;
				font-size: 30px;
				margin: 0px;
				@media print {display : none;};
				z-index: 500;
			}
				
			#Papierkorb {
				position: absolute;
				display: none;
				left: 15px;
				border: dotted thin red;
				top: 63px;
				text-align: center;
				font-size: 30px;
				margin: 0px;
				@media print {display : none;};
				z-index: 500;
			}		
					
			#Schere {
				position: absolute;
				display: none;
				left: 65px;
				border: dotted thin green;
				top: 63px;
				text-align: center;
				font-size: 30px;
				margin: 0px;
				@media print {display : none;};
				z-index: 500;
			}
				
			
			#Imp {
				position: absolute;
				left: 165px;
				top: 15px;
				text-align: center;
				font-size: 14px;
				font-weight: bold;
				margin: 0px;
				@media print {display : none;};
				z-index: 500;
			}
			
			#Exp {
				position: absolute;
				left: 115px;
				top: 15px;
				text-align: center;
				font-size: 14px;
				font-weight: bold;
				margin: 0px;
				@media print {display : none;};
				z-index: 500;
			}
			
			#Speichern {
				position: absolute;
				left: 65px;
				top: 15px;
				text-align: center;
				font-size: 14px;
				font-weight: bold;
				margin: 0px;
				@media print {display : none;};
				z-index: 500;
			}
			
			
			#NEU {
				position: absolute;
				left: 15px;
				top: 15px;
				text-align: center;
				font-size: 14px;
				font-weight: bold;
				margin: 0px;
				@media print {display : none;};
				z-index: 500;
			}
					
			#Übersicht {
				position: absolute;
				left: 265px;
				top: 15px;
				text-align: center;
				font-size: 14px;
				font-weight: bold;
				margin: 0px;
				@media print {display : none;};
				z-index: 500;
			}
			
			.KMEintrag {
				background-color: #f9f9f9;
			}
			
			.KMEintrag:hover {
				background-color: 
				rgba(200, 200, 200, 0.888);
			}
			
			.contextMenu {
				display: none;
				position: absolute;
				background-color: #f9f9f9;
				border: 1px solid #ccc;
				padding: 8px;
				box-shadow: 2px 2px 6px rgba(0, 0, 0, 0.1);
				z-index:500;	
			}
			
			.plus {
				width: 45px;
				height: 45px;
				margin: 5px;
				@media print {display : none;};
			}
				
			#addPlus {
				position: absolute;
				left: 957px;
				font-size: 30px;
			}
			
			#Stift {
				position: absolute;
				left: 5px;
				font-size: 20px;
			}
			
			#BAO_gesamt {
				position: absolute;
				left: 55px;
				text-align: center;
				font-size: 14px;
				font-weight: bold;
			}
			
			#Export {
				position: absolute;
				left: 200px;
			}
				
			#LinieGB {
				position: absolute;
				left: 0px;
				top: 0px;
				height: 100%;
				width: 100%;
			}	
			
			.EAFÜGr {
				border: 1px solid;
				border-bottom: none;
				padding: 5px;
				text-align: left;
				font-size: 12px;
				grid-row: 1 / 1;
				margin: 0px 5px;
			}
			
			.EAFÜGr:hover {
				background-color: rgba(200, 200, 200, 0.888);;
			}
			
			.EAEinzelA {
				border: 1px solid;
				padding: 5px;
				text-align: left;
				font-size: 12px;
				grid-row: 2 / 2;
				margin: 0px 5px;
			}
			
			
			.EAZeile {
				display: grid;
				grid-template-columns: repeat(6, minmax(auto, auto));
				grid-template-rows: repeat(3, auto); 
				/*grid-gap: 15px;*/
			}
			
			.EADigi {
				grid-row: 3 / 3;
				text-align: center;
			}
			
			.EAKnöpfe {
				grid-row: 4 / 4;
				text-align: center;
				margin: 15px;
			}
			
			.EABlockÜberschrift {
				text-align: center;
				color: white;
				background-color: rgb(0 34 102);
				font-size: 14px;
				font-weight: bold;
				padding: 5px 5px;
			}

			.EABlockInhalt {
				text-align: center;
				font-size: 12px;
				padding: 0px 5px;
			}

			.Block {
				padding: 0px 5px;
				display: table-cell;
				position: relative;
				z-index: 260;
			}

			.Kasten {
				margin: 20px;
				border: solid rgb(0 34 102) thin;
				width: max-content;
				margin-left: auto;
				margin-right: auto;
			}

			.Kasten:hover {
				background-color: rgba(200, 200, 200, 0.888);
			}
			
			#BAOFenster {
				visibility: hidden;
				padding: 10px;
				position: absolute;
				left: 0px;
				top: 0px;
				z-index:250;
			}
			
			#BAOSchließen {
				position: absolute;
				left: 10px;
				top: 10px;
			}

			#Linie {
				position: absolute;
				left: 0px;
				top: 0px;
				height: 100%;
				width: 100%;
				z-index: 100;
			} 
			
			#BAOGrafik {
			z-index:260;
			}
			
			#FEM {
				height: 50px;
				width: 100%;
			}
			
			#EAnlass {
				height: 50px; 
				width: 300px;
			}
			
			#Kräfte {
				width: 100%; 
				height: 50px;
			}
			
			#FüGrKräfte {
				width: 100%; 
				height: 50px;
			}
			
			#SpalteEinzelaufträge {
				width: 220px; 
			}	
			
			#Einzelaufträge {
				width: 300px; 
				height: 365px;
			}

			#UASMH {
				width: 250px; 
				height: 443px;
			}
			
			.center {
				text-align: center;
			}
			
			pre {
				white-space: pre-wrap;
				font-family: arial;
				margin: 0px;
			}
			
			p {
				font-size: 12px;
			}
			
			p.digi {
				text-align: center;
				margin-top: -24px;
				margin-bottom: 15px;
				font-size: 12px;
				text-align: center; 
			}
			
			hr.nichtdrucken {
				@media print {display : none;}
			}
			
			.EAKnopf {
				width: 80%;
				margin: 5px;
				border: none; 
				font-size: 12px;
				box-shadow: 0 8px 16px 0 rgba(0,0,0,0.2), 0 6px 20px 0 rgba(0,0,0,0.19);
				border-radius: 3px;
				background-color: rgb(192 0 34);
				color: white;
				@media print {display : none;}
			}
			
			body {	
				font-family: Arial;
				display: flex;
			}
			
			#Dienststelle {
				font-size: 15px;
				font-weight: normal;
				text-align: left;
				margin: 0px;
			}
			
			#Überschrift {	
				font-size: 20px;
				font-weight: bold;
				text-align: center;
				margin: 0px;
			}
				
			#Stand {
				text-align: right; 
				font-size: 10px; 
				vertical-align: top;
			}

			#Seite {
				width: 1000px;
				height: 700px;
				padding: 0;
				z-index: 200;
			}

			#kopf {
				display: flex;
				font-size: 12px;
			}	

			.kopfteil {
				height: 100px;
				border: 1px solid;
				padding: 5px;
			}

			#Polizeiführer {
				margin: 0px 10px 0px 10px;
				width: 200px;
			}
			
			#Anlass {width: 400px;}

			#Führungsgruppe {width: 400px;}

			p {
				margin: 0px;
				padding: 0px;
			}

			.digi {
				font-size: 12px;
			}
			
			#Formular {
				margin: 10px;	
				border: solid black thin;
				background-color:  rgb(207 220 229);
				visibility:hidden;
				padding: 20px;
				position:absolute;
				left: 10px;
				top: 10px;
				z-index: 300;
			}
			
			#SMH {
				margin: 5px;	
				font-size: 14px;
				font-weight: normal;
				text-align: left;
			}
			
			#menu {
				margin: 5px;	
				@media print {display : none;}
			}
			
			.menubutton {
				width: 100px;
				margin: 5px 10px;
				border: none; 
				font-size: 12px;
				box-shadow: 0 8px 16px 0 rgba(0,0,0,0.2), 0 6px 20px 0 rgba(0,0,0,0.19);
				border-radius: 3px;
				background-color: rgb(0 34 102);
				color: white;
			}
			
			.editorbutton {
				width: 200px;
				height: 40px;
				margin: 10px 0px;
				border: solid thin;
			}
			
			.Spalte1 {
				width: 110px;
				vertical-align: top;
				text-align: right;
				padding-right: 10px;
			}
			
			.Spalte2 {
				width: 220px;
			}
			
			input {
				width: 220px;
				font-family: courier new;
			}
			
			#Import {
				margin: 10px;	
				border: solid black thin;
				background-color:  rgb(194 159 99);
				visibility:hidden;
				padding: 20px;
				position:absolute;
				left: 10px;
				top: 10px;
				z-index: 400;
			}		

		</style>

		<style type="text/css">
			:is([id*='google_ads_iframe'],[id*='taboola-'],.taboolaHeight,.taboola-placeholder,#credential_picker_container,#credentials-picker-container,#credential_picker_iframe,[id*='google-one-tap-iframe'],#google-one-tap-popup-container,.google-one-tap-modal-div,#amp_floatingAdDiv,#ez-content-blocker-container) {display:none!important;min-height:0!important;height:0!important;}
		</style>
		
	</head>

	<body ea-data="[{&quot;ENr&quot;:11,&quot;UANr&quot;:[22,33,44,55],&quot;darüber&quot;:&quot;&quot;,&quot;EBezeichnung&quot;:&quot;Einsatzleitung&quot;,&quot;EDatum&quot;:&quot;01.01.2024&quot;,&quot;EAnlass&quot;:&quot;angemeldete Kundgebung am 07.09.2023 - \&quot;Zwangsräumung von Reinhard verhindern!\&quot;&quot;,&quot;EFührer&quot;:&quot;EPHK Super, A 49/4&quot;,&quot;EDst&quot;:&quot;A 49/4&quot;,&quot;EFTelefon&quot;:&quot;0170 55 10 566&quot;,&quot;EFRufname&quot;:&quot;Senta 919&quot;,&quot;EDigi&quot;:&quot;A 49/1&quot;,&quot;LFüGr&quot;:&quot;PHKin Witzig, A 49/41&quot;,&quot;FüGrRufname&quot;:&quot;Senta 924&quot;,&quot;FüGrTelefon&quot;:&quot;0173 2058776&quot;,&quot;FüGrKräfte&quot;:&quot;-/1 A 49&quot;,&quot;Kräfte&quot;:&quot;&quot;,&quot;MZMO&quot;:&quot;15:00 - A 49&quot;,&quot;EZEO&quot;:&quot;17:00 - Einsatzraum&quot;,&quot;FEM&quot;:&quot;Eigene, DibA&quot;,&quot;Einzelaufträge&quot;:&quot;- Freihalten des angeordneten Halteverbotes, \n - ggf. Veranlassung von Umsetzungen, \n - Offene und verdeckte Aufklärung im Nahbereich des Kundgebungsortes: Meldung von relevanten Auffälligkeiten mit Bezug zur Kundgebung, \n- Raumschutz auf den Wegen zum Kundgebungsort mit Fokus auf den ÖPNV (Bushaltestellen, S-Bhf Botanischer Garten und S-Bhf Steglitz), \n- Begleiten von relevanten Personengruppen, \n- Kontrolle der ASG Depots (Zugänglich? Fahrräder angeschlossen?), \n- auf Weisung: Unterstützung EA Kundgebung&quot;,&quot;SMH&quot;:&quot;Hallo&quot;},{&quot;ENr&quot;:22,&quot;UANr&quot;:[],&quot;darüber&quot;:11,&quot;EBezeichnung&quot;:&quot;EA Voraufsicht/Raumschutz&quot;,&quot;EAnlass&quot;:&quot;angemeldete Kundgebung am xx.xx.2023 - Zwangsräumung von Reinhard verhindern! -&quot;,&quot;EFührer&quot;:&quot;A 49/9&quot;,&quot;EDst&quot;:&quot;A 49/4&quot;,&quot;EFTelefon&quot;:&quot;&quot;,&quot;EFRufname&quot;:&quot;S921&quot;,&quot;EDigi&quot;:&quot;A 49/1&quot;,&quot;LFüGr&quot;:&quot;&quot;,&quot;FüGrRufname&quot;:&quot;&quot;,&quot;FüGrTelefon&quot;:&quot;&quot;,&quot;FüGrKräfte&quot;:&quot;&quot;,&quot;Kräfte&quot;:&quot;-/2 A 49/9&quot;,&quot;MZMO&quot;:&quot;&quot;,&quot;EZEO&quot;:&quot;15:00 - Einsatzraum&quot;,&quot;FEM&quot;:&quot;VP-Variable \n eigene \n ausreichend Funktgeräte&quot;,&quot;Einzelaufträge&quot;:&quot;- Freihalten des angeordneten Halteverbotes, \n - ggf. Veranlassung von Umsetzungen, \n - Offene und verdeckte Aufklärung im Nahbereich des Kundgebungsortes: Meldung von relevanten Auffälligkeiten mit Bezug zur Kundgebung, \n- Raumschutz auf den Wegen zum Kundgebungsort mit Fokus auf den ÖPNV (Bushaltestellen, S-Bhf Botanischer Garten und S-Bhf Steglitz), \n- Begleiten von relevanten Personengruppen, \n- Kontrolle der ASG Depots (Zugänglich? Fahrräder angeschlossen?), \n- auf Weisung: Unterstützung EA Kundgebung&quot;,&quot;SMH&quot;:&quot;Was soll ich hier schreiben...&quot;},{&quot;ENr&quot;:33,&quot;UANr&quot;:[],&quot;darüber&quot;:11,&quot;EBezeichnung&quot;:&quot;EA Verkehrsmaßnahmen&quot;,&quot;EAnlass&quot;:&quot;angemeldete Kundgebung am xx.xx.2023 - Zwangsräumung von Reinhard verhindern! -&quot;,&quot;EFührer&quot;:&quot;PHK Mustermann&quot;,&quot;EDst&quot;:&quot;A 49/4&quot;,&quot;EFTelefon&quot;:&quot;&quot;,&quot;EFRufname&quot;:&quot;Senta 670&quot;,&quot;EDigi&quot;:&quot;A 46/1&quot;,&quot;LFüGr&quot;:&quot;&quot;,&quot;FüGrRufname&quot;:&quot;&quot;,&quot;FüGrTelefon&quot;:&quot;&quot;,&quot;FüGrKräfte&quot;:&quot;&quot;,&quot;Kräfte&quot;:&quot;-/3 A 46&quot;,&quot;MZMO&quot;:&quot;17:00 Uhr - A 49&quot;,&quot;EZEO&quot;:&quot;17:30 Uhr  - Einsatzraum&quot;,&quot;FEM&quot;:&quot;VP-Variable \n eigene \n ausreichend Funktgeräte&quot;,&quot;Einzelaufträge&quot;:&quot;Vorbereitung und auf Weisung Errichtung von Verkehrssperren mit Ziel der Herstellung eines verkehrsfeien Raumes \n- Manteuffelstr. zwischen Moltkestr. und Augustaplatz (mit Nachsperren am Kundgebungsort), gesamten Kreuzungsbereich Manteuffelstr./Moltkestr. (mit Nachsperren am Kundgebungsort) \n- Solange der Straßenverkehr läuft: Sicherung der ASG-Line für den Fahrzeugverkehr&quot;,&quot;SMH&quot;:&quot;Was soll ich hier schreiben...&quot;},{&quot;ENr&quot;:44,&quot;UANr&quot;:[],&quot;darüber&quot;:11,&quot;EBezeichnung&quot;:&quot;EA Kundgebung&quot;,&quot;EAnlass&quot;:&quot;angemeldete Kundgebung am xx.xx.2023 - Zwangsräumung von Reinhard verhindern! -&quot;,&quot;EFührer&quot;:&quot;POKin Max&quot;,&quot;EDst&quot;:&quot;A 49/4&quot;,&quot;EFTelefon&quot;:&quot;&quot;,&quot;EFRufname&quot;:&quot;Senta 770&quot;,&quot;EDigi&quot;:&quot;A 47/1&quot;,&quot;LFüGr&quot;:&quot;&quot;,&quot;FüGrRufname&quot;:&quot;&quot;,&quot;FüGrTelefon&quot;:&quot;&quot;,&quot;FüGrKräfte&quot;:&quot;&quot;,&quot;Kräfte&quot;:&quot;-/3 A 47&quot;,&quot;MZMO&quot;:&quot;17:00 Uhr - A 49&quot;,&quot;EZEO&quot;:&quot;17:30 Uhr  - Einsatzraum&quot;,&quot;FEM&quot;:&quot;VP-Variable \n eigene \n ausreichend Funktgeräte&quot;,&quot;Einzelaufträge&quot;:&quot;- Stellen eines Verbindungskraft zur Kundgebungsleitung, Auf- und Abbau AGS, gem. Aufstellplan, \n- Zählen und Melden der Teilnehmer, \n- Melden Beginn und Ende der Kundgebung, \n- Gewährleisten eines störungsfreien Verlaufes, \n- Darauf achten, dass Lautsprecher nur zu Beschallung der Versammlung und nicht der Umgebung eingesetzt werden., \n- Verhinderung und Verfolgung von Straftaten und Ordnungswidrigkeiten aus der Kundgebung heraus. Maßnahmen in der Kundgebung werden nur nach Rücksprache mit Pf getroffen.&quot;,&quot;SMH&quot;:&quot;Was soll ich hier schreiben...&quot;},{&quot;ENr&quot;:55,&quot;UANr&quot;:[66],&quot;darüber&quot;:11,&quot;EBezeichnung&quot;:&quot;EA Objektschutz / Ekdo&quot;,&quot;EAnlass&quot;:&quot;angemeldete Kundgebung am 07.09.2023 - Zwangsräumung von Reinhard verhindern! -&quot;,&quot;EFührer&quot;:&quot;PK Lustig&quot;,&quot;EDst&quot;:&quot;A 49/4&quot;,&quot;EFTelefon&quot;:&quot;&quot;,&quot;EFRufname&quot;:&quot;Senta 870&quot;,&quot;EDigi&quot;:&quot;A 48/1&quot;,&quot;LFüGr&quot;:&quot;&quot;,&quot;FüGrRufname&quot;:&quot;&quot;,&quot;FüGrTelefon&quot;:&quot;&quot;,&quot;FüGrKräfte&quot;:&quot;&quot;,&quot;Kräfte&quot;:&quot;-/3 A 48&quot;,&quot;MZMO&quot;:&quot;17:00 Uhr - A 45&quot;,&quot;EZEO&quot;:&quot;17:30 Uhr  - Einsatzraum&quot;,&quot;FEM&quot;:&quot;VP-Variable \n eigene \n ausreichend Funktgeräte&quot;,&quot;Einzelaufträge&quot;:&quot;- Verhindern, dass unberechtigte/ Versammlungsteilnehmende das Grundstück Manteuffelstr. 5/Moltkestr. 16a betreten oder darauf einwirken, \n- Freihalten der Grundstückzugänge, \n- Kontakt aufnehmen und halten mit Architekturbüro, ggf. auch Anwohnern soweit anwesend., \n- auf Weisung: Unterstützung EA Kundgebung&quot;,&quot;SMH&quot;:&quot;Was soll ich hier schreiben...&quot;},{&quot;ENr&quot;:66,&quot;UANr&quot;:[],&quot;darüber&quot;:55,&quot;EBezeichnung&quot;:&quot;EA Objektschutz / Ekdo&quot;,&quot;EAnlass&quot;:&quot;angemeldete Kundgebung am 07.09.2023 - Zwangsräumung von Reinhard verhindern! -&quot;,&quot;EFührer&quot;:&quot;PK Lustig&quot;,&quot;EDst&quot;:&quot;A 49/4&quot;,&quot;EFTelefon&quot;:&quot;&quot;,&quot;EFRufname&quot;:&quot;Senta 870&quot;,&quot;EDigi&quot;:&quot;A 48/1&quot;,&quot;LFüGr&quot;:&quot;&quot;,&quot;FüGrRufname&quot;:&quot;&quot;,&quot;FüGrTelefon&quot;:&quot;&quot;,&quot;FüGrKräfte&quot;:&quot;&quot;,&quot;Kräfte&quot;:&quot;-/3 A 48&quot;,&quot;MZMO&quot;:&quot;17:00 Uhr - A 45&quot;,&quot;EZEO&quot;:&quot;17:30 Uhr  - Einsatzraum&quot;,&quot;FEM&quot;:&quot;VP-Variable \n eigene \n ausreichend Funktgeräte&quot;,&quot;Einzelaufträge&quot;:&quot;- Verhindern, dass unberechtigte/ Versammlungsteilnehmende das Grundstück Manteuffelstr. 5/Moltkestr. 16a betreten oder darauf einwirken, \n- Freihalten der Grundstückzugänge, \n- Kontakt aufnehmen und halten mit Architekturbüro, ggf. auch Anwohnern soweit anwesend., \n- auf Weisung: Unterstützung EA Kundgebung&quot;,&quot;SMH&quot;:&quot;Was soll ich hier schreiben...&quot;}]">
			
		<!-- --Hauptseite ---->
		
		<div id="Seite" style="visibility: hidden;">
			<table width="100%">
				<tbody>
					<tr>
						<td id="Dienststelle">
							A 49/4
						</td>
						<td id="Überschrift">
							Grafischer Befehl - VS-nfD - <span id="EDatum">Fehler</span> - <span id="EinsatzID">Fehler!</span>
						</td>
						<td id="Stand">24-11-12 - 13-40-06</td>
					</tr>
				</tbody>
			</table>

			<div id="kopf">
				
				<div class="kopfteil" id="Anlass">
					<b>Anlass</b><br>
					<pre>Fehle!r</pre>
				</div>

				<div class="kopfteil" id="Polizeiführer">
					<b>Polizeiführer/in</b><br>
					Fehler!<br>
					Fehler!<br>
					Fehler!
				</div>
				
				<div class="kopfteil" id="Führungsgruppe">
					<b>Führungsgruppe</b><br>
					<table style="width: 100%">
						<tbody>
							<tr>
								<td id="FüGr1" style="width: 50%" valign="TOP">
									Fehler!<br>
									Senta 919<br>
									0173 2058776<br>
									<pre>Fehler!</pre>
								</td>
								<td id="FüGr2" style="width: 50%" valign="TOP">
									MZO:<br>
									Fehler!<br>
									EZO:<br>
									Fehler!</td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>

			<div id="Digigruppe">
				<button class="plus" id="Stift" onclick="Editor(DsNr);">✎</button><button class="plus" id="BAO_gesamt" onclick="BAO_öffnen();">BAO</button><button class="plus" id="addPlus" onclick="EAplus(DsNr);">+</button><svg id="LinienGB"></svg> <svg height="46" style="background-color: white; margin-left: 427px;" width="140px"> <path d="M20,5 h100 l20,20 l-20,20 h-100 l-20,-20 Z" stroke="black" style="fill: white"></path> <text class="digi" style="font-weight: bold;" x="38" y="20">Digigruppe</text> </svg>
				<p class="digi" id="DGruppe">
					A 49/1</p>
			</div>

			<div id="Einsatzabschnitte"> &nbsp;</div>

			<hr class="nichtdrucken" style="margin-top: 15px">

			<p style="margin: 5px; font-size: 20px; text-align: left;">
				<b>Sonstigen Maßnahnen und Hinweise</b>
			</p>

			<div id="SMH">F E H L E R !!!</div>

		</div>

		<!-- --Formular ---->
			
		<div id="Formular" style="visibility: hidden;">
			<form name="EAEingabe">
				<table>
					<tbody>
						<tr valign="top">
							<td style="padding: 10px; width: 350px;">
								<table>
									<tbody>
										<tr id="SpalteEBezeichnung">
											<td class="Spalte1">
												<label for="EBezeichnung">Bezeichnung</label></td>
											<td class="Spalte2">
												<input id="EBezeichnung" name="EBezeichnung"></td>
										</tr>
										<tr>
											<td class="Spalte1">
												<label for="EDatum">Einsatzdatum</label></td>
											<td class="Spalte2">
												<input id="EiDatum" name="EDatum"></td>
										</tr>
										<tr>
											<td class="Spalte1">
												<label for="EFührer">Führer/in</label></td>
											<td class="Spalte2">
												<input id="EFührer" name="EFührer"></td>
										</tr>
										<tr>
											<td class="Spalte1">
												<label for="EDst">Dienststelle</label></td>
											<td class="Spalte2">
												<input id="EDst" name="EDst"></td>
										</tr>
										<tr>
											<td class="Spalte1">
												<label for="EFRufname">Rufname</label></td>
											<td class="Spalte2">
												<input id="EFRufname" name="EFRufname"></td>
										</tr>
										<tr>
											<td class="Spalte1">
												<label for="EFTelefon">Telefon</label></td>
											<td class="Spalte2">
												<input id="EFTelefon" name="EFTelefon"></td>
										</tr>
										<tr>
											<td class="Spalte1">
												<label for="LFüGr">LFüGr</label></td>
											<td class="Spalte2">
												<input id="LFüGr" name="LFüGr"></td>
										</tr>
										<tr>
											<td class="Spalte1">
												<label for="FüGrRufname">FüGr-Rufname</label></td>
											<td class="Spalte2">
												<input id="FüGrRufname" name="FüGrRufname"></td>
										</tr>
										<tr>
											<td class="Spalte1">
												<label for="FüGrTelefon">FüGr-Telefon</label></td>
											<td class="Spalte2">
												<input id="FüGrTelefon" name="FüGrTelefon"></td>
										</tr>
										<tr>
											<td class="Spalte1">
												<label for="FüGrKräfte">FüGr-Kräfte</label></td>
											<td class="Spalte2">
												<input id="FeldFüGrKräfte" name="FeldFüGrKräfte"></td>
										</tr>
										<tr>
											<td class="Spalte1">
												<label for="Kräfte">Kräfte</label></td>
											<td class="Spalte2">
												<input id="FeldKräfte" name="FeldKräfte"></td>
										</tr>
										<tr>
											<td class="Spalte1">
												<label for="MZMO">MZO</label></td>
											<td class="Spalte2">
												<input id="MZMO" name="MZMOA"></td>
										</tr>
										<tr>
											<td class="Spalte1">
												<label for="EZEO">EZO</label></td>
											<td class="Spalte2">
												<input id="EZEO" name="EZEO"></td>
										</tr>
										<tr>
										<!--	<td class="Spalte1">
												<label for="FEM">FEM</label></td>
											<td class="Spalte2">
												<input id="FeldFEM" name="FeldFEM" /></td> -->
										</tr>
										<tr>
											<td class="Spalte1">
												<label for="EDigi">Digi</label></td>
											<td class="Spalte2">
												<input id="EDigi" name="EDigi"></td>
										</tr>
									</tbody>
								</table>
							</td>
							
							<td id="SpalteEinzelaufträge" style="padding: 10px; width: 300px;" valign="top">
								
								<label for="EAnlass">Anlass</label>
									<br>
								
								<span id="FeldEAnlass" name="FeldEAnlass"></span>
									<br>
									<br>
								
								<label for="Einzelaufträge">Einzelaufträge</label>
									<br>
								
								<span id="FeldEinzelaufträge" name="FeldEinzelaufträge"></span>
								
							</td>
							
							<td id="SpalteSMH" style="padding: 10px; width: 200px;" valign="top">
								<label for="UASMH">sonstige Maßnahmen und Hinweise</label>
									<br>
								<span id="FeldUASMH" name="FeldUASMH"></span>
							
							</td>
						</tr>
					</tbody>
				</table>
			</form>
				
			<button class="plus" id="übertragen" onclick="ESpeichern();" style="width: 200px;">Übertragen</button>
			<button class="plus" id="schließen" onclick="Schließen();" style="width: 200px;">ohne Speichern schließen</button><br>
				
			<!--Kontrollfelder-->
			<p style="font-family: Courier New; font-size: 10px; ">
				EANr:<span id="KonEANr"> </span>- UANr:  <span id="KonUANr"> </span> - oE:  <span id="KonDarüber"></span>
			</p>

		</div>
			
		<!---- Import ---->
		
		<div id="Import" style="visibility: hidden;">
			<h1>BAO importieren</h1>
			<p>
				<input id="fileInput" type="file">
				<button class="plus" onclick="importJSON()" style="width: 200px;">Laden</button>
				<button class="plus" id="hoch" onclick="document.getElementById('Import').style.visibility = 'hidden';" style="width: 200px;">Schließen</button>
			</p>
		</div>

		<!---- BAO ---->
		
		<div id="BAOFenster" style="visibility: visible;">
			<div id="Linie">
				<svg id="Linien" style="width: 100%; height: 100%;"><path d="M 372.84375,179v 20 " stroke="black"></path><line x1="118.9609375" y1="199" x2="636.390625" y2="199" stroke="black"></line><path d="M 118.9609375,219v -20 " stroke="black"></path><path d="M 316.1484375,219v -20 " stroke="black"></path><path d="M 475.7265625,219v -20 " stroke="black"></path><path d="M 636.390625,219v -20 " stroke="black"></path><path d="M 636.390625,331v 20 " stroke="black"></path><line x1="636.390625" y1="351" x2="636.390625" y2="351" stroke="black"></line><path d="M 636.390625,371v -20 " stroke="black"></path></svg></div>
			<button class="plus" id="NEU" onclick="neu();">NEU</button><button class="plus" id="Speichern" onclick="speichernhtml();">💾</button><button class="plus" id="Exp" onclick="exportjson();">Exp.</button><button class="plus" id="Imp" onclick="Import();">Imp.</button><button class="plus" id="BAOplus" onclick="BAOplus();">+</button><button class="plus" id="Übersicht" onclick="">BAO</button>
			<div class="plus" id="Papierkorb">🗑</div>
			<div class="plus" id="Schere">✂</div>
			<h1 style="text-align: center; margin: 0; margin-left: 200px;">BAO-Test</h1>
			<div id="BAOGrafik">
				<div class="Block">
					<div id="Block11" class="Kasten">
						<p id="EABÜ11" class="EABlockÜberschrift">Einsatzleitung</p>
						<p class="EABlockInhalt">ENr: 11</p>
						<p class="EABlockInhalt">EDatum: 01.01.2024</p>
						<p class="EABlockInhalt">UANr: 22,33,44,55</p>
						<p class="EABlockInhalt">EDst: A 49/4</p>
						<p class="EABlockInhalt">EFührer: EPHK Super, A 49/4</p>
						<p class="EABlockInhalt">Kräfte: <br></p>
					</div>
					<div class="Block">
						<div id="Block22" class="Kasten">
							<p id="EABÜ22" class="EABlockÜberschrift">EA Voraufsicht/Raumschutz</p>
							<p class="EABlockInhalt">ENr: 22</p>
							<p class="EABlockInhalt">EDatum: undefined</p>
							<p class="EABlockInhalt">UANr: </p>
							<p class="EABlockInhalt">EDst: A 49/4</p>
							<p class="EABlockInhalt">EFührer: A 49/9</p>
							<p class="EABlockInhalt">Kräfte: -/2 A 49/9<br></p>
						</div>
					</div>
				<div class="Block">
					<div id="Block33" class="Kasten">
						<p id="EABÜ33" class="EABlockÜberschrift">EA Verkehrsmaßnahmen</p>
						<p class="EABlockInhalt">ENr: 33</p>
						<p class="EABlockInhalt">EDatum: undefined</p>
						<p class="EABlockInhalt">UANr: </p>
						<p class="EABlockInhalt">EDst: A 49/4</p>
						<p class="EABlockInhalt">EFührer: PHK Mustermann</p>
						<p class="EABlockInhalt">Kräfte: -/3 A 46<br></p>
					</div>
				</div>
				<div class="Block">
					<div id="Block44" class="Kasten">
						<p id="EABÜ44" class="EABlockÜberschrift">EA Kundgebung</p>
						<p class="EABlockInhalt">ENr: 44</p>
						<p class="EABlockInhalt">EDatum: undefined</p>
						<p class="EABlockInhalt">UANr: </p>
						<p class="EABlockInhalt">EDst: A 49/4</p>
						<p class="EABlockInhalt">EFührer: POKin Max</p>
						<p class="EABlockInhalt">Kräfte: -/3 A 47<br></p>
					</div>
				</div>
				<div class="Block">
					<div id="Block55" class="Kasten">
						<p id="EABÜ55" class="EABlockÜberschrift">EA Objektschutz / Ekdo</p>
						<p class="EABlockInhalt">ENr: 55</p><p class="EABlockInhalt">EDatum: undefined</p>
						<p class="EABlockInhalt">UANr: 66</p><p class="EABlockInhalt">EDst: A 49/4</p>
						<p class="EABlockInhalt">EFührer: PK Lustig</p><p class="EABlockInhalt">Kräfte: -/3 A 48<br></p>
					</div>
					<div class="Block">
						<div id="Block66" class="Kasten">
							<p id="EABÜ66" class="EABlockÜberschrift">EA Objektschutz / Ekdo</p>
							<p class="EABlockInhalt">ENr: 66</p>
							<p class="EABlockInhalt">EDatum: undefined</p>
							<p class="EABlockInhalt">UANr: </p>
							<p class="EABlockInhalt">EDst: A 49/4</p>
							<p class="EABlockInhalt">EFührer: PK Lustig</p>
							<p class="EABlockInhalt">Kräfte: -/3 A 48<br></p>
						</div>
					</div>
				</div>
			</div>
		</div>
			
		<div id="BAOKontext">
			<div id="contextMenuBAO11" class="contextMenu">
				<p class="KMEintrag" id="KMbearbeiten11">EA bearbeiten</p>
				<p>
					<span class="KMEintrag" id="KMnachLinks11">◀</span>
					&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
					<span class="KMEintrag" id="KMnachRechts11">▶</span>
				</p>
				<p class="KMEintrag" id="KMUAöffnen11">Grafischer Befehl</p>
			</div>
			<div id="contextMenuBAO22" class="contextMenu">
				<p class="KMEintrag" id="KMbearbeiten22">EA bearbeiten</p>
				<p>
					<span class="KMEintrag" id="KMnachLinks22">◀</span>
					&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
					<span class="KMEintrag" id="KMnachRechts22">▶</span>
				</p>
				<p class="KMEintrag" id="KMUAöffnen22">Grafischer Befehl</p>
			</div>
			<div id="contextMenuBAO33" class="contextMenu">
				<p class="KMEintrag" id="KMbearbeiten33">EA bearbeiten</p>
				<p>
					<span class="KMEintrag" id="KMnachLinks33">◀</span>
					&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
					<span class="KMEintrag" id="KMnachRechts33">▶</span>
				</p>
				<p class="KMEintrag" id="KMUAöffnen33">Grafischer Befehl</p>
			</div>
			<div id="contextMenuBAO44" class="contextMenu">
				<p class="KMEintrag" id="KMbearbeiten44">EA bearbeiten</p>
				<p>
					<span class="KMEintrag" id="KMnachLinks44">◀</span>
					&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
					<span class="KMEintrag" id="KMnachRechts44">▶</span>
				</p>
				<p class="KMEintrag" id="KMUAöffnen44">Grafischer Befehl</p>
			</div>
			<div id="contextMenuBAO55" class="contextMenu">
				<p class="KMEintrag" id="KMbearbeiten55">EA bearbeiten</p>
				<p>
					<span class="KMEintrag" id="KMnachLinks55">◀</span>
					&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
					<span class="KMEintrag" id="KMnachRechts55">▶</span>
				</p>
				<p class="KMEintrag" id="KMUAöffnen55">Grafischer Befehl</p>
			</div>
			<div id="contextMenuBAO66" class="contextMenu">
				<p class="KMEintrag" id="KMbearbeiten66">EA bearbeiten</p>
				<p>
					<span class="KMEintrag" id="KMnachLinks66">◀</span>
					&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
					<span class="KMEintrag" id="KMnachRechts66">▶</span>
				</p>
				<p class="KMEintrag" id="KMUAöffnen66">Grafischer Befehl</p>
			</div>
		</div>

		<script> // **************** Programm ****************	
			

			'use strict';	
			// Daten aus dem Bodytag auslesen

			let EA_JSON = document.body.getAttribute('ea-data');
			let EA = JSON.parse(EA_JSON);
			let DsNr = EA[0].ENr; // LfdNr des Datensatzes zur Identifizierung
			let EABlöcke = ""; // Variable, in der die Einsatzabschnitt dargestellt werden.
			let AktuellEditDsNr; // Die Datensatznummer, die gerade editiert wird. 
			let SKnopfx = [];
			let knopfname = [];
			let	Zeile = [];
			let UA = false;


			let letzteÄnderung = document.lastModified; // Datum der letzten Dateiänderung darstellen
				
			let letzteÄnderung2 = letzteÄnderung.slice(8,10) + "-";
			letzteÄnderung2 += letzteÄnderung.slice(0,2) + "-";
			letzteÄnderung2 += letzteÄnderung.slice(3,5) + " - ";	
			letzteÄnderung2 += letzteÄnderung.slice(11,13) + "-";
			letzteÄnderung2 += letzteÄnderung.slice(14,16) + "-";
			letzteÄnderung2 += letzteÄnderung.slice(17);

			document.getElementById("Stand").innerHTML = letzteÄnderung2;	// Datum der letzten Dateiänderung darstellen
				
			BAO(true);

			BAO_öffnen();
						
			// Ende des regulären Programmablaufes...	


			// ausgelagerte Funktionen

			function Einsatzkopf() { 
				
				window.moveTo(0, 0);

				let aEA = EA.find(elem => elem.ENr === DsNr);

				let PF = "<b>Polizeiführer/in</b><br>" + aEA["EFührer"] + "<br>" + aEA["EFRufname"] + "<br>" + aEA["EFTelefon"];
				let FüGr1 = aEA["LFüGr"] + "<br>" + aEA["EFRufname"] + "<br>" +  aEA["FüGrTelefon"] + "<br><pre>" + aEA["FüGrKräfte"] + "</pre>";	
				let FüGr2 = "MZO:<br>&ensp;" + aEA["MZMO"] + "<br>EZO:<br>&ensp;" + aEA["EZEO"];	
				let Anlass = "<b>Anlass</b><br><pre>" + aEA["EAnlass"] + "</pre>";

				document.getElementById("EinsatzID").innerHTML = DsNr; // Einsatznummer in der Überschrift darstellen
				document.getElementById("Anlass").innerHTML = Anlass;
				document.getElementById("EDatum").innerHTML = aEA.EDatum;
				document.getElementById("Polizeiführer").innerHTML = PF;
				document.getElementById("FüGr1").innerHTML = FüGr1;
				document.getElementById("FüGr2").innerHTML = FüGr2;
				document.getElementById("DGruppe").innerHTML = aEA.EDigi;
				document.getElementById("Dienststelle").innerHTML = aEA.EDst;
				document.getElementById("SMH").innerHTML = "<pre>" + aEA.SMH + "</pre>";
				
			}	


			function Einsatzabschnitte() {	
				
				let aEA = EA.find(elem => elem.ENr === DsNr); //aktueller Einsatz
				
				let AnzahlEA = aEA["UANr"].length;

				if (AnzahlEA > 0) {
				
					switch (true) {
						case AnzahlEA < 7: 		Zeile[1] = 6; Zeile[2] = 0; Zeile[3] = 0; break;
						case AnzahlEA == 7:		Zeile[1] = 4; Zeile[2] = 3;	Zeile[3] = 0; break;
						case AnzahlEA == 8:		Zeile[1] = 4; Zeile[2] = 4;	Zeile[3] = 0; break;
						case AnzahlEA == 9:		Zeile[1] = 5; Zeile[2] = 4;	Zeile[3] = 0; break;
						case AnzahlEA == 10:	Zeile[1] = 5; Zeile[2] = 5;	Zeile[3] = 0; break;
						case AnzahlEA == 11:	Zeile[1] = 6; Zeile[2] = 5;	Zeile[3] = 0; break;
						case AnzahlEA == 12:	Zeile[1] = 6; Zeile[2] = 6;	Zeile[3] = 0; break;
						case AnzahlEA == 13:	Zeile[1] = 5; Zeile[2] = 4;	Zeile[3] = 4; break;
						case AnzahlEA == 14:	Zeile[1] = 5; Zeile[2] = 5;	Zeile[3] = 4; break;
						case AnzahlEA == 15:	Zeile[1] = 5; Zeile[2] = 5;	Zeile[3] = 5; break;
						case AnzahlEA == 16:	Zeile[1] = 6; Zeile[2] = 5;	Zeile[3] = 5; break;
						case AnzahlEA == 17:	Zeile[1] = 6; Zeile[2] = 6;	Zeile[3] = 5; break;
						case AnzahlEA == 18:	Zeile[1] = 6; Zeile[2] = 6;	Zeile[3] = 6; break;
					}
					
				EABlöcke = "";
				
				EABlöcke += "<div class='EAZeile'>";
					
				let s=0; 
				
				let BlockLinie = [];

				for (let x of aEA["UANr"]) {
					s++;
					if (s <= Zeile[1]) {BlockLinie.push(x);}
					if (s == Zeile[1]+1) EABlöcke += "</div><hr class='nichtdrucken' style='margin-top: 15px'><div class='EAZeile'>";	// Ende Zeile 1
					if (s == Zeile[1]+Zeile[2]+1) EABlöcke += "</div><hr class='nichtdrucken' style='margin-top: 15px'><div class='EAZeile'>"; // Ende Zeile 2
					let a6EA = EA.find(elem => elem.ENr === x);
							
					Block(x); //Block erstellen
				}
				
				EABlöcke += "</div>"; // Schluss der Zeile 1,2 oder 3
						
				for (let x of aEA["UANr"]) {Kontextmenu(x);} //Kontextmenu erstellen
				
				document.getElementById("Einsatzabschnitte").innerHTML = EABlöcke; //html Datei erstellen
				
				let y=0;	
				for (let x of aEA["UANr"]) {KontextMEA(x,y++);} //Eventhandler für das Kontextmenu
					
				//Linien für den GB zeichnen
					
				let GBLinie = "";
					
				let EAElement;	
				
				let korrextX = window.scrollX || window.pageXOffset; // horizontale Scrollposition
				let korrextY = window.scrollY || window.pageYOffset; // vertikale Scrollposition

				for (let StricheBG of BlockLinie) {
					EAElement =  "Einsatzabschnitt" + StricheBG;

					let EAObjekt1 = document.getElementById(EAElement);
					let EAObjekt2 = EAObjekt1.getBoundingClientRect();
					
					GBLinie += "<line x1='";
					GBLinie += EAObjekt2.left + ((EAObjekt2.right - EAObjekt2.left)/2) + korrextX ;
					GBLinie += "' y1='";
					GBLinie += EAObjekt2.top + korrextY;
					GBLinie += "' x2='";
					GBLinie += EAObjekt2.left + ((EAObjekt2.right - EAObjekt2.left)/2) + korrextX ;
					GBLinie += "' y2='";
					GBLinie += EAObjekt2.top - 30 + korrextY;
					GBLinie += "' stroke='black'/>";
				}

				let StricheBG2 = BlockLinie[0]
				EAElement = "Einsatzabschnitt" + StricheBG2 ;
				let EAObjekt3 = document.getElementById(EAElement);
				let EAObjekt4 = EAObjekt3.getBoundingClientRect();	
				let StricheBG3 = BlockLinie[(BlockLinie.length - 1)];
				EAElement = "Einsatzabschnitt" + StricheBG3 ;
				let EAObjekt5 = document.getElementById(EAElement);
				let EAObjekt6 = EAObjekt5.getBoundingClientRect();
				
				GBLinie += "<line x1='";
				GBLinie += EAObjekt4.left + ((EAObjekt4.right - EAObjekt4.left)/2) + korrextX;
				GBLinie += "' y1='";
				GBLinie += EAObjekt4.top - 30 + korrextY;
				GBLinie += "' x2='";
				GBLinie += EAObjekt6.left + ((EAObjekt6.right - EAObjekt6.left)/2) + korrextX;
				GBLinie += "' y2='";
				GBLinie += EAObjekt6.top - 30 + korrextY;
				GBLinie += "' stroke='black'/>";
				
				document.getElementById("LinienGB").innerHTML = GBLinie;

				} else {
				document.getElementById("Einsatzabschnitte").innerHTML = "<h1 style='text-align: center'>Keine EA vorhanden!<br></h1>";
				document.getElementById("LinienGB").innerHTML = "";
				}

			}	


			function BAO(BAODsNr) { 
				
				//BAO_öffnen();
				//document.getElementById("BAOFenster").style.visibility = "visible";
				//document.getElementById("Seite").style.visibility = "hidden";
				
				var BAOStruktur = "";
				
				let darstellung = false;

				let korrektX = window.scrollX || window.pageXOffset; // horizontale Scrollposition
				let korrektY = window.scrollY || window.pageYOffset; // vertikale Scrollposition
				let BlID; 
				let BAOLinien = "";
				
				if (BAODsNr) {
					for (let BAOBlock of EA) {
						if (BAOBlock.darüber == "") BAOStruktur += Blockdarstellung(BAOBlock);  // der erste Block wird nur dargestellt, wenn es keinen EA darüber gibt. Es handelt sich um einen eigenständigen Einsatz.
					}
				} else {
					for (let BAOBlock of EA) {
						if (BAOBlock.ENr == DsNr) BAOStruktur += Blockdarstellung(BAOBlock); 
					}	
				}
				
				document.getElementById("BAOGrafik").innerHTML = BAOStruktur;


				let Durchlauf = 0; // Das erste Kästchen darf kein Strich ofen haben... 

				for (let Striche of EA) {

					BlID = "Block" + Striche.ENr;

					let meinDiv = document.getElementById(BlID); //  die aktuellen Koordinaten des Div-Elements zu ermitteln
					
					if (meinDiv) {  //nur wenn der EA existriert wird der folgende Code ausgeführt
					
						let rect = meinDiv.getBoundingClientRect() //|| "kein Objekt"; // DOMRect-Objekt abrufen
					
						let mitteX =  (rect.right - rect.left) / 2 + rect.left;
						let obenP =  (mitteX + korrektX) + "," + (rect.top + korrektY);
						let untenP =  (mitteX + korrektX) + "," + (rect.bottom + korrektY);	
						
						//Linie sektrecht oben:
						++Durchlauf;
						if (Striche.darüber != "" && Durchlauf != 1 ) { 
							BAOLinien += "<path d='M "; 
							BAOLinien += obenP;
							BAOLinien += "v -20 ' stroke='black' />";
						}
						
						//Linie senkrecht unten:
						if (Striche.UANr != "") {
							BAOLinien += "<path d='M ";
							BAOLinien += untenP;
							BAOLinien += "v 20 ' stroke='black' />";

							//Querstrich 
								//von links ...
								let BlID1 = "Block" + Striche.UANr[0];
								let meinDiv1 = document.getElementById(BlID1);
								let rect1 = meinDiv1.getBoundingClientRect();
								let X1 =  (rect1.right - rect1.left) / 2 + rect1.left;
								let Y1 =  rect1.top;

								//nach recht
								let BlID2 = "Block" + Striche.UANr[Striche.UANr.length-1];
								let meinDiv2 = document.getElementById(BlID2);
								let rect2 = meinDiv2.getBoundingClientRect();
								let X2 =  (rect2.right - rect2.left) / 2 + rect2.left;

								BAOLinien += "<line x1='"; //Querstrich zeichnen
								BAOLinien += X1 + korrektX;
								BAOLinien += "' y1='";
								BAOLinien += Y1 - 20 + korrektY ;
								BAOLinien += "' x2='";
								BAOLinien += X2 + korrektX;
								BAOLinien += "' y2='";
								BAOLinien += Y1 - 20 + korrektY ;
								BAOLinien += "' stroke='black'/>";
						}
					}
				}

				document.getElementById("Linien").innerHTML = BAOLinien;
						
				let BAOKontextblockDiv = "";
				//BAO - Kontextmenüerstellung
				for (let xx of EA) {
					BAOKontextblockDiv += BAOKontextmenu(xx.ENr);
				}
				
				document.getElementById("BAOKontext").innerHTML = BAOKontextblockDiv;
					
				
				//BAO - Kontextmenüaktionen und Überwachung
				for (let BAOBlock of EA) BAOKontextMEA(BAOBlock.ENr); //Kontextmenü - Überwachung
				
				//BAO - BLockaktionen	
				for (let DoppelklickObj of EA) {
					let KlickBlock = "Block" + DoppelklickObj.ENr;
					let DownBlock = "EABÜ" + DoppelklickObj.ENr;
					let BlockKlick = document.getElementById(KlickBlock);
					let BlockDown = document.getElementById(DownBlock);
					
					if (BlockKlick) {	

						//Doppelklick öffnet den Grafischen Befehl - FEHLER
						BlockKlick.addEventListener('dblclick', function () {
							DsNr = DoppelklickObj.ENr;
							GB_öffnen();
						},false);

						//Verschieben
						if (BAODsNr) { //nur verschiebar wenn es sich nicht um einen EA oder UA handelt
							BlockDown.addEventListener('mousedown', function () {verschieben(DoppelklickObj);},false)
						}
					}	
				} 
			}

						
			function Blockdarstellung(Block) {
				
				let BAOStruktur2 = "";
				BAOStruktur2 += "<div class='Block'>";
				BAOStruktur2 += "<div id='Block" + Block.ENr + "' class='Kasten'>";	
				BAOStruktur2 += "<p id='EABÜ" + Block.ENr + "' class='EABlockÜberschrift'>" + Block.EBezeichnung  + "</p>" ;
				BAOStruktur2 += "<p class='EABlockInhalt'>ENr: " + Block.ENr  + "</p>" ;
				BAOStruktur2 += "<p class='EABlockInhalt'>EDatum: " + Block.EDatum  + "</p>" ;
				BAOStruktur2 += "<p class='EABlockInhalt'>UANr: " + Block.UANr  + "</p>" ;
				BAOStruktur2 += "<p class='EABlockInhalt'>EDst: " + Block.EDst  + "</p>" ;
				BAOStruktur2 += "<p class='EABlockInhalt'>EFührer: " + Block.EFührer  + "</p>" ;
				BAOStruktur2 += "<p class='EABlockInhalt'>Kräfte: " + Block.Kräfte  + "<br></p>" ;	
				BAOStruktur2 += "</div>";			// Kasten schließen
					
				//BAOStruktur2 += BAOKontextmenu(Block.ENr);
				
				for (let UnterBlöcke of Block.UANr) {
					let UnterBlock = EA.find(elem => elem.ENr === UnterBlöcke);
					BAOStruktur2 += Blockdarstellung(UnterBlock);
				}
				
				BAOStruktur2 += "</div>";	//Block schließen
				
				return BAOStruktur2;	
			}
						
						
			function verschieben(DoppelklickObj) {

				let BlockPosName = "Block" + DoppelklickObj.ENr;
				let BlockPosID = document.getElementById(BlockPosName);
				let BlockPosKo = BlockPosID.getBoundingClientRect();
				let DivMove = document.createElement('div');	
				let DivMoveStyle = 'z-index: 2000; position: absolute; background: rgba(100, 100, 100, 0.5);';
					
				DivMoveStyle += 'width: ' + BlockPosKo.width + 'px;';
				DivMoveStyle += 'height: ' + BlockPosKo.height + 'px;';
				DivMoveStyle += 'left: ' + (BlockPosKo.left + window.scrollX) + 'px;';
				DivMoveStyle += 'top: ' + (BlockPosKo.top + window.scrollY) + 'px;';
				
				DivMove.setAttribute('style', DivMoveStyle);
				DivMove.setAttribute('id', 'MoveBlock');

				document.body.appendChild(DivMove);

				//Papierkorb nur anzeigen, wenn das Objekt gelöscht werden kann. Es darf nicht das letzte oberste Objekt sein.
				let PapierkorbAnzeigen = true;
				if (!DoppelklickObj.darüber) {
					
					let AnzahlEAdarüber = 0
					
					for (let EAD of EA) {
						if (!EAD.darüber) AnzahlEAdarüber++ ; 
					}
					
					if (AnzahlEAdarüber == 1) PapierkorbAnzeigen = false;
				}
							
				if (PapierkorbAnzeigen) document.getElementById("Papierkorb").style.display = "block";
							
				// Schere nur anzeigen wenn es "darüber" gibt
				if (DoppelklickObj.darüber) document.getElementById("Schere").style.display = "block";
				
				DivMove.addEventListener('mousemove', function(e) {
					DivMove.style.left = e.clientX - DivMove.clientWidth / 2 + window.scrollX + 'px';
					DivMove.style.top = e.clientY - DivMove.clientHeight / 2 + window.scrollY + 'px';
				},false);
				
				DivMove.addEventListener('mouseup', function() { MausAuf(DoppelklickObj.ENr) }, false);
				
			}


			function Block(EABlock) {

				let a2EA = EA.find(elem => elem.ENr === EABlock);

				EABlöcke += "<div class='EAFÜGr' id='Einsatzabschnitt" + a2EA["ENr"] + "'><p style='text-align: center'><b>(" + a2EA["ENr"] + ") ";
					EABlöcke += a2EA["EBezeichnung"] + "</b></p>";
					EABlöcke += "<hr><p>Führer: " + a2EA["EFührer"] + "</p>";
					EABlöcke += "<hr><p>Telefon: " + a2EA["EFTelefon"] + " / " + a2EA["FüGrTelefon"] + "</p>";
					EABlöcke += "<hr><p>Rufname: " + a2EA["EFRufname"] + " / " + a2EA["FüGrRufname"] + "</p>";
					EABlöcke += "<hr><p>Kräfte: <pre>" + a2EA["Kräfte"] + "</pre></p>";
					EABlöcke += "<hr><p>MZO: " + a2EA["MZMO"] + "</p>";
					EABlöcke += "<hr><p>EZO: " + a2EA["EZEO"] + "</p>";
				EABlöcke += "</div>";	
				
				EABlöcke += "<div class='EAEinzelA'><b>Einzelaufträge:</b><br><pre>" + a2EA["Einzelaufträge"] + "</pre></p>";
				EABlöcke += "</div>";
					
				EABlöcke += "<p class='EADigi'><svg style='margin-bottom: -26px' width='140px' height='55'>";
					EABlöcke += "<text class='digi' x='38' y='25' style='font-weight: bold;'>Digigruppe</text>";
					EABlöcke += "<path d='M20,10 h100 l20,20 l-20,20 h-100 l-20,-20 Z' stroke='black' style='fill: none'></path></svg>";
				EABlöcke += "<br><span>" + a2EA["EDigi"] + "</span></p>";
			} 


			function IndexENr(WertENr) { //die Funktion ermittelt den Index zur ENr (DatensatzID)
				for (let i = 0 ; i < EA.length ; i++ ) {
					if (EA[i].ENr == WertENr) {return i;}
				}	
			}


			function AufElementAbgelegt (PosX, PosY, Element) {
				let PosObj = document.getElementById(Element);
				let BlockTop 	= PosObj.getBoundingClientRect().top + window.scrollY;
				let BlockBottom = PosObj.getBoundingClientRect().bottom + window.scrollY;
				let BlockLeft   = PosObj.getBoundingClientRect().left + window.scrollX;
				let BlockRight  = PosObj.getBoundingClientRect().right + window.scrollX;

				if (PosX > BlockLeft && PosX < BlockRight && PosY > BlockTop && PosY < BlockBottom ) { return true; }

				return false;
			}


			function MausAuf(Start) {
				
				let DivMoveEnde = document.getElementById("MoveBlock");
				let PosX = DivMoveEnde.getBoundingClientRect().left + DivMoveEnde.clientWidth / 2 + window.scrollX;
				let PosY = DivMoveEnde.getBoundingClientRect().top + DivMoveEnde.clientHeight / 2 + window.scrollY;
				DivMoveEnde.remove(); //nachdem die Position bestimmt war, wird das Element gelöscht

				//Auf Papierkorp abgelegt?
					if (AufElementAbgelegt (PosX, PosY, "Papierkorb")) {
						EALöschen(Start);
						BAO(true);
					}

				//Auf Schere abgelegt?
					if (AufElementAbgelegt (PosX, PosY, "Schere")) {
						EAWirklichHerauslösen(Start);
						BAO(true);
					}

				//Auf einem anderen Block abgelegt?
				for (let PosEA of EA) {

					if (AufElementAbgelegt (PosX, PosY, "Block"+PosEA.ENr )) {

						let Ziel = PosEA.ENr;
						
						let ZulässigVerschoben =  EAaufUA(Start, Ziel);

						if (ZulässigVerschoben) {
							
							let verschiebeDS 	= EA[IndexENr(Start)];
							let darüberDSalt 	= EA[IndexENr(verschiebeDS.darüber)];
							let darüberDSneu 	= EA[IndexENr(Ziel)];

							//alte UANr. Bezug löschen
							if (darüberDSalt) {
								for (let i = 0; i < darüberDSalt.UANr.length; i++) {
									if (darüberDSalt.UANr[i] === Start) darüberDSalt.UANr.splice(i, 1);
								}
							}

							//neue UANr. Bezug setzen
							darüberDSneu.UANr.push(Start);

							//neue "darüber" ersetzen
							verschiebeDS.darüber = Ziel;

							//Ansicht aktualisieren
							Einsatzkopf();
							Einsatzabschnitte();
							BAO(true);
						}
					}
				}

				//element wieder unsichtbar machen:
				document.getElementById("Papierkorb").style.display = "none";
				document.getElementById("Schere").style.display = "none";

			}


			function EAaufUA(Start, Ziel) {
				if (Start == Ziel) { return false; }
				if (Ziel == EA[IndexENr(Start)].darüber) { return false;}
				return EAaufUA2(Start, Ziel);
			}


			function EAaufUA2(Start, Ziel) {
				for (let P2 of EA[IndexENr(Start)].UANr) {
					if (P2 == Ziel) { return false; }
					if (!EAaufUA2(P2, Ziel)) {return false;}
				}
				return true;
			}


			function speichernhtml() {
				
				// Array in JSON umwandeln
				var EA_AlsJSON = JSON.stringify(EA);

				// JSON in HTML speichern (als Beispiel im body-Element)
				document.body.setAttribute('EA-DATA', EA_AlsJSON);

				// Den gesamten HTML-Code der Seite erfassen
				var htmlCode = "<!DOCTYPE html>\n" + document.documentElement.outerHTML;

				// Erstellen eines Blob-Objekts mit dem HTML-Code
				var blob = new Blob([htmlCode], { type: "text/html" });

				// Erstellen eines Download-Links
				var a = document.createElement("a");
				a.href = URL.createObjectURL(blob);
				a.download = Zeitstempel() + " - Grafischer Befehl.html";

				// Hinzufügen des Links zum DOM und Auslösen des Klicks
				document.body.appendChild(a);
				a.click();

				// Entfernen des Links aus dem DOM
				document.body.removeChild(a);
			}	

			function Kontextmenu(x) { //hier wird das Kontextmenü für jeden einezelnen dargestellten Einsatzabschnitt dargestellt, damit es auch identifizierbar ist
				EABlöcke += "<div id='contextMenu" + x + "' class='contextMenu' >";
				EABlöcke += "<p class='KMEintrag' id='KMbearbeiten" + x + "'>EA bearbeiten</p>";
				EABlöcke += "<p><span class='KMEintrag' id='KMnachLinks" + x + "'>&#9664;</span>";
				EABlöcke +=	"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";
				EABlöcke += "<span class='KMEintrag' id='KMnachRechts" + x + "'>&#9654;</span></p>";
				EABlöcke += "<p class='KMEintrag' id='KMUAöffnen" + x + "'>Grafischer Befehl</p>";
				EABlöcke += "<p class='KMEintrag' id='KMentlassen" + x + "'>EA entlassen</p>";
				EABlöcke += "<p class='KMEintrag' id='KMlöschen" + x + "'>EA löschen</p>";
				EABlöcke += "</div>";
			}	
				

			function KontextMEA(EANrKM,index) {
				
				// Elemente abrufen
				var targetElement = document.getElementById('Einsatzabschnitt'+EANrKM);
				var KontextID = "contextMenu" + EANrKM;
				var contextMenu = document.getElementById(KontextID);

				// Kontextmenü anzeigen
				targetElement.addEventListener('contextmenu', function (e) {
					e.preventDefault(); // Standardkontextmenü unterdrücken
					contextMenu.style.display = 'block';
					contextMenu.style.left = e.pageX + 'px';
					contextMenu.style.top = e.pageY + 'px';
				});

				// Kontextmenü ausblenden, wenn außerhalb geklickt wird
				document.addEventListener('click', function () {contextMenu.style.display = 'none'; });
				
				//Aktionen:
				let KMbearbeiten = document.getElementById('KMbearbeiten'+EANrKM);
				let KMlinks = document.getElementById('KMnachLinks'+EANrKM);
				let KMrechts = document.getElementById('KMnachRechts'+EANrKM);
				let KMUAöffnen = document.getElementById('KMUAöffnen'+EANrKM);
				let KMentlassen = document.getElementById('KMentlassen'+EANrKM);
				let KMlöschen = document.getElementById('KMlöschen'+EANrKM);
					
				KMbearbeiten.addEventListener('click', function() {Editor(EANrKM);});
				KMlinks.addEventListener('click', function() {shiftLeft(index);});
				KMrechts.addEventListener('click', function() {shiftRight(index);});
				KMUAöffnen.addEventListener('click', function() {UAöffnen(EANrKM);});
				KMentlassen.addEventListener('click', function() {EAherauslösen(EANrKM);});
				KMlöschen.addEventListener('click', function() {EALöschen(EANrKM);});
			}


			function BAOKontextmenu(x) { //hier wird das Kontextmenü für jeden einezelnen dargestellten Einsatzabschnitt dargestellt, damit es auch identifizierbar ist
				let übergabe = "<div id='contextMenuBAO" + x + "' class='contextMenu' >";
				übergabe += "<p class='KMEintrag' id='KMbearbeiten" + x + "'>EA bearbeiten</p>";
				übergabe += "<p><span class='KMEintrag' id='KMnachLinks" + x + "'>&#9664;</span>";
				übergabe +=	"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";
				übergabe += "<span class='KMEintrag' id='KMnachRechts" + x + "'>&#9654;</span></p>";
				übergabe += "<p class='KMEintrag' id='KMUAöffnen" + x + "'>Grafischer Befehl</p>";
				übergabe += "</div>";
				
				return übergabe;
			}		

			function BAOKontextMEA(EANrKM) {
				// Elemente abrufen
				
				let targetElement = document.getElementById('Block'+EANrKM);
				let KontextID = "contextMenuBAO" + EANrKM;
				let contextMenu = document.getElementById(KontextID);
				
				//solte das Element nicht existieren, dann die weitere funktion abbrechen.
					if (!targetElement) return;
				
				// Kontextmenü anzeigen
				
				targetElement.addEventListener('contextmenu', function (f) {
					f.preventDefault(); // Standardkontextmenü unterdrücken
					contextMenu.style.display = 'block';
					contextMenu.style.left = f.pageX + 'px';
					contextMenu.style.top = f.pageY + 'px';
				});

				// Kontextmenü ausblenden, wenn außerhalb geklickt wird
					document.addEventListener('click', function () {contextMenu.style.display = 'none'; });
				
				//Aktionen:
				let KMbearbeiten = document.getElementById('KMbearbeiten'+EANrKM);
				let KMlinks = document.getElementById('KMnachLinks'+EANrKM);
				let KMrechts = document.getElementById('KMnachRechts'+EANrKM);
				let KMUAöffnen = document.getElementById('KMUAöffnen'+EANrKM);
					
				KMbearbeiten.addEventListener('click', function() {Editor(EANrKM);});
				KMlinks.addEventListener('click', function() {console.log("Links");});
				KMrechts.addEventListener('click', function() {console.log("Rechts");});
				KMUAöffnen.addEventListener('click', function() {
					DsNr = EANrKM;
					GB_öffnen();
				});
			}
								
						
			function EALöschen(EntferneDsNr) {

				let Bestätigung = confirm("Soll der EA wirklich gelöscht werden? Die unterstellten UA werden ebenfalls gelöscht und können nicht wiederhergestellt werden. ");
				if (Bestätigung) { 
					EAwirklichLöschen(EntferneDsNr);
					Einsatzabschnitte();
				}
			}


			function EAwirklichLöschen(EntferneEA) {		
				let IndexLöschen = IndexENr(EntferneEA);
				if (EA[IndexLöschen].darüber) EAWirklichHerauslösen(EntferneEA); // Verbindung darüber löschen
				EAwirklichLöschen2(EntferneEA); // erst dann die Einsätze nacheinander löschen
			}
				
						
			function EAwirklichLöschen2(EntferneEA)	{
				let IndexLöschen = IndexENr(EntferneEA);
				for (let EAL of EA[IndexLöschen].UANr) EAwirklichLöschen2(EAL); // erst eventuell vorhandene UA löschen
				
				// EA löschen
				let nDsNr = false;
				
				if (EA[IndexLöschen].ENr == DsNr) nDsNr = true; //wenn der fokussierte Datensatz gelöscht wird, muss ein neuer Datensatz festgelegt werden. 
				EA.splice(IndexLöschen,1);
				
				if (nDsNr) {
					for (let neuerDsNr of EA) {
						if (!neuerDsNr.darüber) DsNr = neuerDsNr.ENr ; // der erste Datensatz, der ohne "darüber" gefunden wird, bekommt den Focus!
					}
				}
			}
						
						
			function shiftLeft(index) { //Berechnungsfunktion, um die Einsatzabschnitte nach links zu verschieben
				let EAV = EA.find(elem => elem.ENr === DsNr);
				if (index > 0 && index < EAV.UANr.length) {        
					const element = EAV.UANr.splice(index, 1)[0];  	// Entferne das Element an der gegebenen Position
					EAV.UANr.splice(index - 1, 0, element);			// Füge es vor dem Element an der Position (index - 1) ein
				}

				Einsatzabschnitte();
			}
				

			function shiftRight(index) { //Berechnungsfunktion, um die Einsatzabschnitte nach rechts zu verschieben	
				let EAV = EA.find(elem => elem.ENr === DsNr);
				if (index >= 0 && index <EAV.UANr.length - 1) {
					const element = EAV.UANr.splice(index, 1)[0];		// Entferne das Element an der gegebenen Position
					EAV.UANr.splice(index + 1, 0, element); 			// Füge es am Ende des Arrays ein
				}
				
				Einsatzabschnitte();
			}


			function EAherauslösen(EAHerauslösen) {

				let Bestätigung = confirm("Soll der EA wirklich aus dem Einsatz enlassen bzw. aus dieser BAO ausgeglieder werden? Sollten unterstellten UA vorhanden sein, bleiben diese in ihrem bestehenden Unterstellungsverhältnis. Der EA wird in der Gesamt-BOA als eigener Einsatz angezeigt. Umgliederungen können in der Gesamt-BAO-Ansicht geändert werden. ");
				if (Bestätigung) {EAWirklichHerauslösen(EAHerauslösen);}
			}


			function EAWirklichHerauslösen(EAHerauslösen) {

					let a7EA = EA.find(elem => elem.ENr === EAHerauslösen);
					let a8EA = EA.find(elem => elem.ENr === a7EA.darüber);
					a7EA.darüber = "";
					let t = 0;

					for (let LUA of a8EA.UANr) {
						if (EAHerauslösen == LUA) {a8EA.UANr.splice(t,1);}
						t++;	
					}

				Einsatzabschnitte(); //Datenansicht in den Einsatzabschnitten aktualisieren 
			}	


			function UAöffnen(Aufklappen) {
				DsNr = Aufklappen;
				Einsatzkopf(); //Datenansicht  im Kopf aktualisieren
				Einsatzabschnitte(); //Datenansicht in den Einsatzabschnitten aktualisieren 
			}


			function Editor(editnr) {
				console.log ("Nummer: " + editnr);
				document.getElementById("Formular").style.visibility = "visible";
				document.getElementById("Seite").style.visibility = "hidden";

				let a3EA = EA.find(elem => elem.ENr === editnr);
				
				AktuellEditDsNr = editnr;	
				
				//Formularfelder füllen
				document.getElementById('KonEANr').innerHTML = a3EA["ENr"];
				document.getElementById('KonUANr').innerHTML = a3EA["UANr"];
				document.getElementById('KonDarüber').innerHTML = a3EA["darüber"];
				document.getElementById('EDst').value = a3EA["EDst"];
				document.getElementById('EiDatum').value = a3EA.EDatum;
				document.getElementById('EBezeichnung').value = a3EA["EBezeichnung"];
				document.getElementById('FeldEAnlass').innerHTML = "<textarea id='EAnlass'>" +  a3EA["EAnlass"] + "</textarea>";
				document.getElementById('EFührer').value = a3EA["EFührer"];
				document.getElementById('EFTelefon').value = a3EA["EFTelefon"];
				document.getElementById('EFRufname').value = a3EA["EFRufname"];
				document.getElementById('EDigi').value = a3EA["EDigi"];
				document.getElementById('LFüGr').value = a3EA["LFüGr"];
				document.getElementById('FüGrTelefon').value = a3EA["FüGrTelefon"];
				document.getElementById('FüGrRufname').value = a3EA["FüGrRufname"];
				document.getElementById('FeldFüGrKräfte').innerHTML = "<textarea id='FüGrKräfte'>" +  a3EA["FüGrKräfte"] + "</textarea>";
				document.getElementById('FeldKräfte').innerHTML = "<textarea id='Kräfte'>" +  a3EA["Kräfte"] + "</textarea>";
				document.getElementById('MZMO').value = a3EA["MZMO"];
				document.getElementById('EZEO').value = a3EA["EZEO"];
				//document.getElementById('FeldFEM').innerHTML = "<textarea id='FEM'>" +  a3EA["FEM"] + "</textarea>";
				document.getElementById('FeldEinzelaufträge').innerHTML = "<textarea id='Einzelaufträge'>" + a3EA["Einzelaufträge"]  + "</textarea>";
				document.getElementById('FeldUASMH').innerHTML = "<textarea id='UASMH'>" + a3EA['SMH'] + "</textarea>";
			}


			function Schließen() { //Schießen den Editorfensters
				document.getElementById("Formular").style.visibility = "hidden";
				//document.getElementById("Seite").style.visibility = "visible";
			}


			function ESpeichern() {

				let a4EA = EA.find(elem => elem.ENr === AktuellEditDsNr);

				//Daten auf das Array übertragen
				a4EA["EDst"] = document.getElementById('EDst').value;
				a4EA["EBezeichnung"] = document.getElementById('EBezeichnung').value;
				a4EA["EDatum"] = document.getElementById('EiDatum').value;
				a4EA["EAnlass"] = document.getElementById('EAnlass').value;
				a4EA["EFührer"] = document.getElementById('EFührer').value;
				a4EA["EFTelefon"] = document.getElementById('EFTelefon').value;
				a4EA["EFRufname"] = document.getElementById('EFRufname').value;
				a4EA["EDigi"] = document.getElementById('EDigi').value;
				a4EA["LFüGr"] = document.getElementById('LFüGr').value;
				a4EA["FüGrRufname"] = document.getElementById('FüGrRufname').value;
				a4EA["FüGrTelefon"] = document.getElementById('FüGrTelefon').value;
				a4EA["FüGrKräfte"] = document.getElementById('FüGrKräfte').value;
				a4EA["Kräfte"] = document.getElementById('Kräfte').value;
				a4EA["MZMO"] = document.getElementById('MZMO').value;
				a4EA["EZEO"] = document.getElementById('EZEO').value;
				//a4EA["FEM"] = document.getElementById('FEM').value;
				a4EA["Einzelaufträge"] = document.getElementById('Einzelaufträge').value;
				a4EA["SMH"] = document.getElementById('UASMH').value;
				
				Einsatzkopf(); //Datenansicht  im Kopf aktualisieren
				Einsatzabschnitte(); //Datenansicht in den Einsatzabschnitten aktualisieren 

				document.getElementById('Formular').style.visibility = 'hidden';
				document.getElementById("Seite").style.visibility = "visible";	 
			}


			function neuerEA(x) {
				
				let nENr = Math.max(...EA.map(obj => obj.ENr))+1;
				
				if (nENr == "-Infinity") nENr = 1;
				
				let neueNr = EA.length;

				EA[neueNr] = new Object();
				EA[neueNr]["ENr"] = nENr;
				EA[neueNr]["UANr"] = [];
				EA[neueNr]["darüber"] = x; // hier wird der Datensatz darüber festgelegt.
				EA[neueNr]["EBezeichnung"] = "n.n.";
				EA[neueNr]["EDatum"] = "n.n.";
				EA[neueNr]["EAnlass"] = "n.n.";
				EA[neueNr]["EFührer"] = "n.n.";
				EA[neueNr]["EDst"] = "n.n.";
				EA[neueNr]["EFTelefon"] = "n.n.";
				EA[neueNr]["EFRufname"] = "n.n.";
				EA[neueNr]["EDigi"] = "n.n.";
				EA[neueNr]["LFüGr"] = "n.n.";
				EA[neueNr]["FüGrRufname"] = "n.n.";
				EA[neueNr]["FüGrTelefon"] = "n.n.";
				EA[neueNr]["FüGrKräfte"] = "n.n.";
				EA[neueNr]["Kräfte"] = "n.n.";
				EA[neueNr]["MZMO"] = "n.n.";
				EA[neueNr]["EZEO"] = "n.n.";
				EA[neueNr]["FEM"] = "n.n.";
				EA[neueNr]["Einzelaufträge"] = "n.n.";
				EA[neueNr]["SMH"] = "n.n.";

				if (x) {
					let a5EA = EA.find(elem => elem.ENr === DsNr);
					a5EA["UANr"].push(nENr); // bei UANr. die aktuelle EA-Nr angehängen
				}

				//Einsatzabschnitte(); // Einsatzabschnitte neu darstellen

			}


			function Zeitstempel() {
				let Zeitwert = new Date().toISOString().slice(2,19); 
				Zeitwert = Zeitwert.slice(0,8) + "_" + Zeitwert.slice(9,11) + Zeitwert.slice(12,14) + Zeitwert.slice(15,17);
				return Zeitwert;
			}


			function exportjson() {

				let filename = Zeitstempel() + " - Einsatzabschnitt";
				let text = EA;
				let element = document.createElement('a');
				element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(JSON.stringify(EA)));
				element.setAttribute('download', filename + ".BAO");

				element.style.display = 'none';
				document.body.appendChild(element);

				element.click();

				document.body.removeChild(element);
			}


			function Import() {
				document.getElementById("Import").style.visibility = "visible";
				document.getElementById("Seite").style.visibility = "hidden";
			}

			function EAplus() {
				neuerEA(DsNr);
				GB_öffnen();
			}
						
			function BAOplus() {
				neuerEA("");
				BAO(true);
			}			
						
			function importJSON() {
				// Dateiinput-Element auswählen
				var fileInput = document.getElementById('fileInput');

				// Sicherstellen, dass eine Datei ausgewählt wurde
				if (!fileInput.files.length) {
					alert('Bitte wählen Sie eine Datei aus.');
					return;
				}

				// FileReader erstellen
				var reader = new FileReader();

				// Event-Handler für das Laden der Datei
				reader.onload = function(e) {
					try {
						// JSON-Parsing
						var ImportierteEA = JSON.parse(e.target.result);
						
					} catch (error) {
						console.error('Fehler beim Parsen der JSON-Datei:', error);
						alert("Es ist ein Fehler aufgetreten! Die Datei wurde nicht importiert!");
						return; 
					}
					
						let groessteEANr = Math.max(...EA.map(obj => obj.ENr));
						
						ImportierteEA.forEach((ImportierterDatensatz) => {
							
							ImportierterDatensatz.ENr = ImportierterDatensatz.ENr + groessteEANr;
							
							ImportierterDatensatz.UANr.forEach((ImportUANr, i) => {
								ImportUANr = ImportUANr + groessteEANr;
								ImportierterDatensatz.UANr[i] = ImportUANr;
							});
											
							if (ImportierterDatensatz.darüber) ImportierterDatensatz.darüber = ImportierterDatensatz.darüber + groessteEANr;
							
							EA.push(ImportierterDatensatz);	
						});

					BAO(true);
					
				};
					
					//Datei lesen
					reader.readAsText(fileInput.files[0]);
					document.getElementById("Import").style.visibility = "hidden";
			}
						
			function neu() {
				
				let Bestätigung = confirm("ACHTUNG! Es werden alle Daten gelöscht, die Datei aber nicht überschrieben. Sie können die Datei anschließend unter einem anderen Namen speichern! Soll eine neue BAO/ein neuer Grafischer Befehl angelegt werden?");
				if (Bestätigung) { 
					EA = []; // alle Daten löschern
					neuerEA();
					DsNr = EA[0].ENr;
					EA[0].darüber = "";	
					neuerEA(EA[0].ENr);
					neuerEA(EA[0].ENr);	
					neuerEA(EA[0].ENr);
					
					BAO_öffnen();
				}
			}

			function BAO_öffnen() {
				BAO(true);
				document.getElementById("Import").style.visibility = "hidden";
				document.getElementById("Seite").style.visibility = "hidden";
				document.getElementById("Formular").style.visibility = "hidden";
				document.getElementById("BAOFenster").style.visibility = "visible";
			}
						
			function GB_öffnen() {
				Einsatzkopf();
				Einsatzabschnitte();
				document.getElementById("Import").style.visibility = "hidden";
				document.getElementById("Seite").style.visibility = "visible";
				document.getElementById("Formular").style.visibility = "hidden";
				document.getElementById("BAOFenster").style.visibility = "hidden";
			}
						
			function IMPORT_öffnen() {
				document.getElementById("Import").style.visibility = "visible";
				document.getElementById("Seite").style.visibility = "hidden";
				document.getElementById("Formular").style.visibility = "hidden";
				document.getElementById("BAOFenster").style.visibility = "hidden";
			}
						
			function Editor_öffnen() {
				document.getElementById("Import").style.visibility = "hidden";
				document.getElementById("Seite").style.visibility = "hidden";
				document.getElementById("Formular").style.visibility = "visible";
				document.getElementById("BAOFenster").style.visibility = "hidden";
			}
						
		</script>
	</body>
</html>
